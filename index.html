<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>ğŸ£ Fishing Simulator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:system-ui,sans-serif;
background:url("https://images.unsplash.com/photo-1502082553048-f009c37129b9") center/cover no-repeat}
.overlay{background:rgba(0,0,0,.45);min-height:100vh;padding:12px}
.header{text-align:center;color:#fff;font-size:26px;font-weight:700;margin-bottom:12px}
.menu{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;max-width:420px;margin:0 auto}
.menu-btn{background:linear-gradient(#8b5a2b,#5c3a1e);border-radius:14px;padding:12px 6px;
text-align:center;color:#fff;font-weight:600}
.menu-btn span{display:block;font-size:26px}
.screen{display:none;max-width:420px;margin:12px auto 0;background:#fff;border-radius:16px;padding:14px}
.screen.active{display:block}
button{width:100%;padding:14px;margin:6px 0;border:none;border-radius:14px;font-size:16px}
.primary{background:#ffd000;font-weight:700}
.gray{background:#eee}
.locked{background:#ddd;color:#888}
.ton{background:#7c5cff;color:#fff;font-weight:700}
.r-common{color:#444}
.r-rare{color:#1e88e5;font-weight:600}
.r-legend{color:#8e24aa;font-weight:700}
</style>
</head>

<body>
<div class="overlay">

<div class="header">ğŸ£ Ğ Ğ˜Ğ‘ĞĞ›ĞšĞ</div>

<div class="menu">
  <div class="menu-btn" onclick="openScreen('fishing')"><span>ğŸ£</span>Ğ Ğ¸Ğ±Ğ°Ğ»ĞºĞ°</div>
  <div class="menu-btn" onclick="openScreen('inventory')"><span>ğŸ’</span>Ğ†Ğ½Ğ²ĞµĞ½Ñ‚Ğ°Ñ€</div>
  <div class="menu-btn" onclick="openScreen('locations')"><span>ğŸ—º</span>Ğ›Ğ¾ĞºĞ°Ñ†Ñ–Ñ—</div>
  <div class="menu-btn" onclick="openScreen('shop')"><span>ğŸ›’</span>ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½</div>
  <div class="menu-btn" onclick="openScreen('stats')"><span>ğŸ“–</span>Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°</div>
</div>

<div id="fishing" class="screen">
  <h3>ğŸ£ Ğ Ğ¸Ğ±Ğ°Ğ»ĞºĞ° â€” <span id="locName"></span></h3>
  <button class="primary" onclick="catchFish()">Ğ—Ğ°ĞºĞ¸Ğ½ÑƒÑ‚Ğ¸ Ğ²ÑƒĞ´ĞºÑƒ</button>
  <button class="gray" onclick="sellFish()">ğŸ’° ĞŸÑ€Ğ¾Ğ´Ğ°Ñ‚Ğ¸ Ñ€Ğ¸Ğ±Ñƒ</button>
  <div id="catch"></div>
</div>

<div id="inventory" class="screen">
  <h3>ğŸ’ Ğ†Ğ½Ğ²ĞµĞ½Ñ‚Ğ°Ñ€</h3>
  <div id="inv"></div>
</div>

<div id="locations" class="screen">
  <h3>ğŸ—º Ğ›Ğ¾ĞºĞ°Ñ†Ñ–Ñ—</h3>
  <div id="locList"></div>
</div>

<div id="shop" class="screen">
  <h3>ğŸ›’ ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½</h3>
  <h4>ğŸ£ Ğ’ÑƒĞ´ĞºĞ¸</h4>
  <div id="shopRods"></div>
  <h4>ğŸª± ĞĞ°Ğ¶Ğ¸Ğ²ĞºĞ°</h4>
  <div id="shopBait"></div>
  <h4>ğŸŒ¾ ĞŸÑ€Ğ¸ĞºĞ¾Ñ€Ğ¼</h4>
  <div id="shopFeed"></div>
  <h4>ğŸ§° Ğ¡Ğ½Ğ°ÑÑ‚Ñ–</h4>
  <div id="shopGear"></div>
</div>

<div id="stats" class="screen">
  <h3>ğŸ“– Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°</h3>
  <div id="statsText"></div>
</div>

</div>

<script>
/* ===== RESET SAFE LOAD ===== */
function loadGame(){
  try{
    const d=JSON.parse(localStorage.getItem("fishingGame"));
    return d && d.coins!==undefined ? d : null;
  }catch{ return null }
}
function saveGame(){
  localStorage.setItem("fishingGame",JSON.stringify(player));
}

/* ===== PLAYER ===== */
let player=loadGame()||{
  fish:{},
  tonFish:0,
  coins:0,
  tons:0,
  level:1,
  location:0,
  rod:0,
  bait:0,
  feed:0,
  gear:{landingNet:false},
  lastTonCatch:0
};

/* ===== DATA ===== */
const rods=[
  {name:"Ğ¡Ñ‚Ğ°Ñ€Ğ° Ğ²ÑƒĞ´ĞºĞ°",power:1,price:0},
  {name:"Ğ”Ğ¾Ğ±Ñ€Ğ° Ğ²ÑƒĞ´ĞºĞ°",power:2,price:50},
  {name:"ĞŸÑ€Ğ¾Ñ„Ñ– Ğ²ÑƒĞ´ĞºĞ°",power:3,price:250},
  {name:"Ğ¢ÑƒÑ€Ğ±Ğ¾ Ğ²ÑƒĞ´ĞºĞ°",power:4,price:500},
  {name:"Ğ›ĞµĞ³ĞµĞ½Ğ´Ğ°Ñ€Ğ½Ğ° Ğ²ÑƒĞ´ĞºĞ°",power:5,tonPrice:15,legendary:true}
];

const baitItems=[
  {name:"Ğ§ĞµÑ€Ğ²'ÑĞº",price:20,uses:5,power:1},
  {name:"ĞĞ¿Ğ°Ñ€Ğ¸Ñˆ",price:50,uses:10,power:1}
];

const feedItems=[
  {name:"ĞŸÑ€Ğ¾ÑÑ‚Ğ¸Ğ¹ Ğ¿Ñ€Ğ¸ĞºĞ¾Ñ€Ğ¼",price:40,casts:5},
  {name:"ĞŸÑ€ĞµĞ¼Ñ–ÑƒĞ¼ Ğ¿Ñ€Ğ¸ĞºĞ¾Ñ€Ğ¼",price:120,casts:10}
];

const gearItems=[
  {id:"landingNet",name:"ĞŸÑ–Ğ´ÑĞ°ĞºĞ°",tonPrice:5,tonBonus:0.05}
];

const rarityTable=[
  {key:"common",name:"âšª Ğ—Ğ²Ğ¸Ñ‡Ğ°Ğ¹Ğ½Ğ°",chance:0.7,mult:1,cls:"r-common"},
  {key:"rare",name:"ğŸ”µ Ğ Ñ–Ğ´ĞºÑ–ÑĞ½Ğ°",chance:0.25,mult:1.5,cls:"r-rare"},
  {key:"legend",name:"ğŸŸ£ Ğ›ĞµĞ³ĞµĞ½Ğ´Ğ°Ñ€Ğ½Ğ°",chance:0.05,mult:3,cls:"r-legend"}
];

const locations=[
  {name:"ğŸŒŠ ĞĞ·ĞµÑ€Ğ¾",level:1,fish:[{name:"ĞšĞ°Ñ€Ğ°ÑÑŒ",weight:10},{name:"ĞĞºÑƒĞ½ÑŒ",weight:9}]},
  {name:"ğŸŒ¿ Ğ¡Ñ‚Ğ°Ğ²Ğ¾Ğº",level:3,fish:[{name:"Ğ›Ğ¸Ğ½",weight:8},{name:"ĞšĞ°Ñ€Ğ°ÑÑŒ Ğ²ĞµĞ»Ğ¸ĞºĞ¸Ğ¹",weight:7}]},
  {name:"ğŸŒ… Ğ Ñ–Ñ‡ĞºĞ°",level:6,fish:[{name:"ĞšĞ¾Ñ€Ğ¾Ğ¿",weight:6},{name:"Ğ©ÑƒĞºĞ°",weight:5}]},
  {name:"ğŸŒŒ ĞœĞ¾Ñ€Ğµ",level:10,fish:[{name:"Ğ¢ÑƒĞ½ĞµÑ†ÑŒ",weight:3},{name:"ĞœĞ°Ñ€Ğ»Ñ–Ğ½",weight:2}]},
  {name:"ğŸŒŠ ĞĞºĞµĞ°Ğ½",level:15,fish:[{name:"ĞĞºÑƒĞ»Ğ°",weight:1}]}
];

/* ===== CORE ===== */
function rollRarity(){
  let r=Math.random(),a=0;
  for(let x of rarityTable){a+=x.chance;if(r<=a)return x}
  return rarityTable[0];
}
function openScreen(id){
  document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

function catchFish(){
  const rod=rods[player.rod];
  const now=Date.now();

  let tonChance=(rod.legendary?0.10:0)+(player.gear.landingNet?0.05:0);
  if(tonChance>0 && now-player.lastTonCatch>86400000 && Math.random()<tonChance){
    player.lastTonCatch=now;
    player.tonFish++;
    document.getElementById("catch").innerText="ğŸ’ Ğ¡Ğ¿Ñ–Ğ¹Ğ¼Ğ°Ğ² TON-Ñ€Ğ¸Ğ±Ñƒ!";
    saveGame();render();return;
  }

  let power=rod.power;
  if(player.bait>0){power++;player.bait--}
  if(player.feed>0){power++;player.feed--}

  const rarity=rollRarity();
  const loc=locations[player.location];
  const fish=loc.fish[Math.min(Math.floor(Math.random()*power),loc.fish.length-1)];
  const key=`${fish.name}|${rarity.key}`;
  player.fish[key]=(player.fish[key]||0)+1;

  document.getElementById("catch").innerHTML=
    `ğŸ£ ${fish.name} <span class="${rarity.cls}">(${rarity.name})</span>`;
  saveGame();render();
}

function sellFish(){
  let coins=0;
  for(let k in player.fish){
    const [name,rar]=k.split("|");
    const r=rarityTable.find(x=>x.key===rar);
    for(let l of locations){
      let f=l.fish.find(x=>x.name===name);
      if(f) coins+=Math.floor((player.fish[k]/f.weight)*r.mult);
    }
  }
  player.coins+=coins;
  player.tons+=player.tonFish;
  player.fish={}; player.tonFish=0;
  document.getElementById("catch").innerText=`ğŸ’° +${coins} ğŸª™ | ğŸ’ +TON`;
  saveGame();render();
}

function buyRod(i){
  const r=rods[i];
  if(r.tonPrice){alert("TON Ğ¿Ñ–Ğ´ĞºĞ»ÑÑ‡Ğ¸Ğ¼Ğ¾ Ğ¾ĞºÑ€ĞµĞ¼Ğ¾");return}
  if(player.coins>=r.price){player.coins-=r.price;player.rod=i}
  saveGame();render();
}
function buyBait(i){
  const b=baitItems[i];
  if(player.coins>=b.price){player.coins-=b.price;player.bait+=b.uses}
  saveGame();render();
}
function buyFeed(i){
  const f=feedItems[i];
  if(player.coins>=f.price){player.coins-=f.price;player.feed+=f.casts}
  saveGame();render();
}
function buyGear(id){
  const g=gearItems.find(x=>x.id===id);
  if(player.tons>=g.tonPrice && !player.gear[id]){
    player.tons-=g.tonPrice;player.gear[id]=true
  }
  saveGame();render();
}
function changeLocation(i){
  if(player.level>=locations[i].level){player.location=i;openScreen("fishing")}
  saveGame();render();
}

function render(){
  document.getElementById("locName").innerText=locations[player.location].name;

  let inv=[];
  for(let k in player.fish){
    const [n,r]=k.split("|");
    const rr=rarityTable.find(x=>x.key===r);
    inv.push(`${n} <span class="${rr.cls}">(${rr.name})</span>: ${player.fish[k]}`);
  }
  if(player.tonFish>0) inv.push(`ğŸ’ TON-Ñ€Ğ¸Ğ±Ğ°: ${player.tonFish}`);
  document.getElementById("inv").innerHTML=inv.length?inv.join("<br>"):"ĞŸĞ¾Ñ€Ğ¾Ğ¶Ğ½ÑŒĞ¾";

  document.getElementById("locList").innerHTML=
    locations.map((l,i)=>player.level>=l.level
      ? `<button class="gray" onclick="changeLocation(${i})">${l.name}</button>`
      : `<button class="locked">${l.name} (lvl ${l.level})</button>`
    ).join("");

  document.getElementById("shopRods").innerHTML=
    rods.map((r,i)=>r.tonPrice
      ? `<button class="ton">ğŸ’ ${r.name} â€” ${r.tonPrice} TON</button>`
      : `<button class="gray" onclick="buyRod(${i})">${r.name} â€” ${r.price} ğŸª™</button>`
    ).join("");

  document.getElementById("shopBait").innerHTML=
    baitItems.map((b,i)=>`<button class="gray" onclick="buyBait(${i})">${b.name} â€” ${b.price} ğŸª™ (+${b.uses})</button>`).join("");

  document.getElementById("shopFeed").innerHTML=
    feedItems.map((f,i)=>`<button class="gray" onclick="buyFeed(${i})">${f.name} â€” ${f.price} ğŸª™ (${f.casts} Ğ·Ğ°ĞºĞ¸Ğ´Ñ–Ğ²)</button>`).join("");

  document.getElementById("shopGear").innerHTML=
    gearItems.map(g=>player.gear[g.id]
      ? `<button class="locked">âœ… ${g.name}</button>`
      : `<button class="ton" onclick="buyGear('${g.id}')">ğŸ’ ${g.name} â€” ${g.tonPrice} TON (+5% TON)</button>`
    ).join("");

  document.getElementById("statsText").innerHTML=
    `ğŸª™ ĞœĞ¾Ğ½ĞµÑ‚Ğ¸: ${player.coins}<br>
     ğŸ’ TON: ${player.tons}<br>
     â­ Ğ Ñ–Ğ²ĞµĞ½ÑŒ: ${player.level}<br>
     ğŸ£ Ğ’ÑƒĞ´ĞºĞ°: ${rods[player.rod].name}`;
}

render();
</script>
</body>
</html>
